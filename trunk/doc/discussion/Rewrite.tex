\section{Rewriting - {ANDREAS}}
\label{sect:disc:rewriting}
In section \ref{sect:method:ast_rewrite} on page
\pageref{sect:method:ast_rewrite}, some methods for rewriting (normalising)
certain expressions to XQuery Core were described. In the prototype implementation,
these rewrites are made using the \texttt{RewriteVisitor} class. The advantage
of normalising to XQuery core is simplification of the syntax tree while
maintaining full semantics. That is -- the final syntax tree may be bigger and
appear morre complex. However, expressions such as FLWOR and path expressions
are split into smaller subexpressions that are easier to parse by themselves. 

This project has taken an pragmatic approach to normalisation. The rules
defined in chapter \ref{chapter:translation} do not rely on normalisations.
However, for the sake of simplicity in the prototype, a rewrite visitor was 
applied to simplify FLWOR expressions. This must be seen in the light of the
fact that XQuery Core is a very extensive specification, and so strict
adherence to this specification would imply a substantially larger amount of
effort into normalisation.


\begin{itemize}
  \item fordeler vs ulemper med \aa~skrive om til core
  \item man mister jo informasjon\ldots. Hvis den er p\aa~denne m\aa ten --> gj\o re det akkurat
	  slik, en sp\o rring som skal gi tilsvarende svar er ikke sikkert at man kan
	  skrive p\aa~den samme m\aa ten helt uten videre..  
  \item samme svar = samme utf\o relse = er dette en fordel?
  \item kan man utnytte kunnskap om translation til \aa~optimisere xquery queries?
  \item hva med \aa~bare skrive om det man trenger? Hva trenger man \aa~skriveom?
  \item sl\aa~sammen scopes blir frem og tilbake og frem igjen om man tenker core\ldots /a/b/c-> for..for..for ->
  /a/b/c
  \item se om det er mer tungvinne ting Core har\ldots har ikke satt meg helt inn i alle detaljene der.. hva skjer
  med predikater? blir de if.then.else? kan det hende at vi f\aa r un\o dvendige kryssprodukt?
  \item sluppet where-regel hvis man skriver om til if-then-else (dagens where er mer effektiv enn en if() then no
 e else tomt -> den VET at det som er usant blir kasta bort- jfr regel og select-operator)
 \item TD forutsetter ikke fullversjon XQuery (anti core), da core er subset av fullversjon
\end{itemize}