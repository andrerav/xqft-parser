\section{Comparison}
\label{sect:results:comparison}
\subsection{Assumptions}
This comparison must be seen in the context of a number of assumptions
about the systems being compared. With regards to fairness, it is important to
note that the algebra trees generated by Pathfinder may have been
optimised (to which the exact extent is not known), while the algebra trees
generated by the prototype developed throughout this project \emph{does not apply any optimalisations} at all. The
optimalisations applied by Pathfinder are noted
in \cite{pathfinder_purelyRelational}.

Some important effects on the Pathfinder algebra tree from these
optimalisations are:
\begin{itemize}
  \item The cartesian products between a loop relation and a constant
  subexpression are transformed into projections
  \item The custom operator \textsf{attach} is roughly a simpler equivalent to
  the \textsf{make()} operator in MQL (see section \ref{sect:method:mql}, page
  \pageref{sect:method:mql})
\end{itemize}

\newpage
\subsection{DAG comparison}
Note that the readability for these DAG comparisons are not essential --
however, links to large-scale versions of these diagrams are noted in appendix
\ref{appendix:links_and_resources}.

\begin{figure}[!h]
	\centering
	\mbox{
		\subfigure[Pathfinder/MonetDB]{		
			\includegraphics[width=0.4\textwidth]{img/graphs/td_impl_flwor_simple_pathfinder}
			\label{fig:result:comparison:simple_dag}
		}
		\quad
		\subfigure[Prototype implementation]{
		
			\includegraphics[width=0.6\textwidth]{img/graphs/td_impl_flwor_simple_xq_relalg}
			\label{fig:result:comparison:simple_pathfinder_dag}
		}
	}
	\caption{Comparison of DAGs for the trivial expression in section
	\ref{sect:results:algebra:generated:trivial_flwor}}
\end{figure}

\newpage
\begin{figure}[!h]
	\centering
	\mbox{
		\subfigure[Pathfinder/MonetDB]{		
			\includegraphics[width=0.3\textwidth]{img/graphs/td_impl_flwor_ifthenelse_pathfinder}
			\label{fig:result:comparison:conditional_dag}
		}
		\quad
		\subfigure[Prototype implementation]{
		
			\includegraphics[width=0.7\textwidth]{img/graphs/td_impl_flwor_ifthenelse_xq_relalg_dag}
			\label{fig:result:comparison:conditional_pathfinder_dag}
		}
	}
	\caption{Comparison of DAGs for the conditional expression in section
	\ref{sect:results:algebra:generated:conditional_flwor}}
\end{figure}

\newpage
\begin{figure}[!h]
	\centering
	\mbox{
		\subfigure[Pathfinder/MonetDB]{		
			\includegraphics[width=0.37\textwidth]{img/graphs/td_impl_flwor_complex_pathfinder}
			\label{fig:result:comparison:complex_xqft_dag}
		}
		\quad
		\subfigure[Prototype implementation]{
		
			\includegraphics[width=0.6\textwidth]{img/graphs/td_impl_flwor_complex_xq_relalg_dag}
			\label{fig:result:comparison:complex_pathfinder_dag}
		}
	}
	\caption{Comparison of DAGs for the complex expression in section
	\ref{sect:results:algebra:generated:complex_flwor}}
\end{figure}

\newpage
\subsection{Complexity estimation and comparison}
Complexity estimation is performed as detailed in section
\ref{sect:method:complexity}. The comparison matrix shown in table
\ref{table:result:complexity_matrix} details the differences in
\textit{complexity}. This result is also charted in figures
\ref{fig:results:comparison:chart1} and \ref{fig:results:comparison:chart2}.
Additionally, the \textit{tuple I/O complexity} differences for \textsf{join}
and \textsf{sort} operators are shown in figures
\ref{table:result:complexity_matrix_tio_1} and
\ref{table:result:complexity_matrix_tio_1}.

Refer to section \ref{sect:method:complexity} on page
\pageref{sect:method:complexity} for a detailed account of these complexity
estimations.

\begin{table}[!htp]
 \begin{center} 
 \begin{tabular}{| c | c | c || c | c |}
  \hline
   & \multicolumn{2}{|c||}{\textbf{Pathfinder/MonetDB}}
   & \multicolumn{2}{|c|}{\textbf{Prototype implementation}} \\
   \hline
   & Tuples & Fields & Tuples & Fields \\  
   \hline
   Trivial & 16 & 16 & 15 & 18 \\  
   \hline
   Complex & 215 & 265 & 136 & 102 \\
   \hline
   Conditional & 94 & 50 & 31 & 44 \\  
   \hline
 \end{tabular}
\caption{Complexity comparison matrix}
\label{table:result:complexity_matrix}
 \end{center}
\end{table}

\begin{figure}[!htp]
\begin{center}
  \includegraphics[width=1.0\textwidth]{diagrams/comparison_chart2_chart1}
  \caption{Comparison of complexity based on tuple creation}
  \label{fig:results:comparison:chart1}
\end{center}
\end{figure}

\begin{figure}[!htp]
\begin{center}
  \includegraphics[width=1.0\textwidth]{diagrams/comparison_chart2_chart2}
  \caption{Comparison of complexity based on field creation}
  \label{fig:results:comparison:chart2}
\end{center}
\end{figure}

% Joins
\begin{table}[!htp]
 \begin{center}
 \begin{tabular}{| c | c | c | c | c | c | c | c |}
  \hline
   & \multicolumn{7}{|c|}{\textbf{Pathfinder}} \\
   \hline
   &  & \multicolumn{3}{|c|}{\textbf{In}} &
   \multicolumn{3}{|c|}{\textbf{Out}}  \\
   \hline
   &  \# & Min & Max & Avg & Min & Max & Avg\\
   \hline
   Trivial & 0 & 0 & 0 & 0 & 0 & 0 & 0  \\
   \hline
   Complex & 3 & 6 & 14 & 12.67 & 4 & 14 & 10  \\
   \hline
   Conditional & 3 & 4 & 6 & 4.67 & 1 & 2 & 1.67  \\
   \hline
   %\hline
   & \multicolumn{7}{|c|}{\textbf{Prototype}} \\
   \hline
   &  & \multicolumn{3}{|c|}{\textbf{In}} & 
   \multicolumn{3}{|c|}{\textbf{Out}} \\
   \hline
   & \# & Min & Max & Avg & Min & Max & Avg \\ 
   \hline 
   Trivial & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
   \hline
   Complex & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
   \hline
   Conditional & 2 & 3 & 6 & 4.5 & 3 & 6 & 4.5 \\
   \hline
 \end{tabular}
\caption{Tuple input/output in join operators}
\label{table:result:complexity_matrix_tio_1}
 \end{center}
\end{table}

% Sorts
\begin{table}[!htp]
 \begin{center}
 \begin{tabular}{| c | c | c | c | c | c | c | c |}
  \hline
   & \multicolumn{7}{|c|}{\textbf{Pathfinder}} \\
   \hline
   &  & \multicolumn{3}{|c|}{\textbf{In}} &
   \multicolumn{3}{|c|}{\textbf{Out}}  \\
   \hline
   &  \# & Min & Max & Avg & Min & Max & Avg\\
   \hline
   Trivial & 1 & 3 & 3 & 3 & 3 & 3 & 3  \\
   \hline
   Complex & 6 & 2 & 14 & 8.8 & 2 & 14 & 8.8  \\
   \hline
   Conditional & 2 & 2 & 2 & 2 & 2 & 2 & 2  \\
   \hline
   %\hline
   & \multicolumn{7}{|c|}{\textbf{Prototype}} \\
   \hline
   &  & \multicolumn{3}{|c|}{\textbf{In}} &
   \multicolumn{3}{|c|}{\textbf{Out}} \\
   \hline
   & \# & Min & Max & Avg & Min & Max & Avg \\
   \hline
   Trivial & 2 & 3 & 3 & 3 & 3 & 3 & 3 \\
   \hline
   Complex & 6 & 2 & 14 & 9.33 & 2 & 14 & 9.33 \\
   \hline
   Conditional & 2 & 2 & 2 & 2 & 2 & 2 & 2 \\
   \hline
 \end{tabular}
\caption{Tuple input/output in sort operators}
\label{table:result:complexity_matrix_tio_2}
 \end{center}
\end{table}