\chapter{Tainting Dependencies}
\label{sect:translation}
\label{chapter:translation}


One of the greatest challenges in translating XQuery to relational algebra, is
to translate the semantics of iterators. The iterative nature of expressions
such as \texttt{for} expressions and the bulk oriented relational processing
may seem contradictory. But because XQuery is a purely functional language, and
thus free of side effects, it is semantically sound to evaluate all iterations
of the iterator body in parallel.

In this chapter we will first present MarkXRemove. This was the first iterator translation proposal of this
project. As it had some flaws, the method was reinvented and evolved into Tainting Dependencies (TD), accomodating
for the deficiencies of MarkXRemove. The rest of the chapter is dedicated to this method. First some concepts will
be discussed, followed by methods for translating various features of XQuery into MQL relational algebra trees,
including the translation of iterators. Finally, the chapter will discuss some possible simplifications of trees
generated with TD.

\input{translation/MarkAndRemove}

\input{translation/RuleExpl.tex}
\input{translation/BasicsDepTaint.tex}
\input{translation/LitAndSequence.tex}
\input{translation/FLWOR.tex}
\input{translation/BinaryOps.tex}
\input{translation/CondAndFull.tex}
\input{translation/Quantified.tex}
\input{translation/PathPred.tex}
\input{translation/Simplifications.tex}

\section{Summary}
\label{sect:trans:summary}

In this chapter we have presented Tainting Dependencies -- a method for
translating XQuery expressions into MQL relational algebra trees. Some of the
base concepts behind the method is iterator dependencies and interator dependency tainting. An expression dependent
on an iterator will have a relational representation for each iteration of that iterator. This
dependency can taint another expression, if that expression is a subexpression
of an expression whose evaluation requires representation for all iterations.
We have presented methods for translating features of XQuery complying to the
implications of tainting and dependencies. Finally, we presented some possible
simplifications of trees generated with TD. In section
\ref{sect:disc:notSupported} we will discuss translation of XQuery features
not presented in this chapter.
